<!DOCTYPE html>
<html>
<head>
  <title>Login Page</title>
</head>
<body>
  <h2>Login</h2>
  <form id="loginForm">
    <label for="userId">ID:</label><br>
    <input type="text" id="userId" name="userId" required><br><br>
    <label for="pin">PIN:</label><br>
    <input type="password" id="pin" name="pin" required><br><br>
    <select id="role" required>
      <option value="">Select Role</option>
      <option value="student">Student</option>
      <option value="teacher">Teacher</option>
      <option value="principal">Principal</option>
    </select><br><br>
    <button type="submit">Login</button>
  </form>

  <p id="status" style="color:red;"></p>

  <script>
    document.getElementById("loginForm").addEventListener("submit", function(e) {
      e.preventDefault();

      const id = document.getElementById("userId").value;
      const pin = document.getElementById("pin").value;
      const role = document.getElementById("role").value;

      const url = "https://script.google.com/macros/s/AKfycbzqRwxhDAMt9OpeRaPGR_Htzl_Qv0hX5KPoBDYvISF4zmvv8A0OqNo0tD-NYWc9MI-Q/exec";

      fetch(`${url}?id=${encodeURIComponent(id)}&pin=${encodeURIComponent(pin)}&role=${role}`)
        .then(response => response.json())
        .then(data => {
          if (data.success) {
            // Redirect to the correct dashboard
            if (role === "student") {
              window.location.href = `student_dashboard.html?id=${id}`;
            } else if (role === "teacher") {
              window.location.href = `teacher_dashboard.html?id=${id}`;
            } else if (role === "principal") {
              window.location.href = `principal_dashboard.html?id=${id}`;
            }
          } else {
            document.getElementById("status").innerText = data.message || "Invalid login.";
          }
        })
        .catch(error => {
          console.error("Error:", error);
          document.getElementById("status").innerText = "Error connecting to server.";
        });
    });
  </script>
</body>
</html>
